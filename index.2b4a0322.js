!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){var n=t.flat(),r=n.map(function(t,e){return 0===t?e:null}).filter(function(t){return null!==t});if(0===r.length)return t;for(var i=0;i<e&&0!==r.length;i++){var a=Math.floor(Math.random()*r.length),s=r.splice(a,1)[0],o=.9>Math.random()?2:4;n[s]=o}for(var l=[];n.length;)l.push(n.splice(0,4));return l}function r(t){var e=function(t){for(var e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++)if(0===t[e][n])return!1;return!0}(t),n=function(t){for(var e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++)if(2048===t[e][n])return!0;return!1}(t);return e?"lose":n?"win":"playing"}function i(t,e){for(var n=0,r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++)e[r][i]>t[r][i]&&(n+=e[r][i]);return n}var a=new/*#__PURE__*/(function(){var t;function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),this.state="idle",this.score=0,this.initialState=t}return t=[{key:"moveLeft",value:function(){if("idle"!==this.state){var t=this.initialState.map(function(t){return function(t){for(var e=0;e<t.length-1;e++)t[e]===t[e+1]&&0!==t[e]&&(t[e]*=2,t[e+1]=0);for(var n=t.filter(function(t){return 0!==t});n.length<t.length;)n.push(0);return n}(t)});this.state=r(t),this.score+=i(this.initialState,t);var e=n(t,1);return this.initialState=e,this.initialState}}},{key:"moveRight",value:function(){if("idle"!==this.state){var t=this.initialState.map(function(t){return function(t){for(var e=t.filter(function(t){return 0!==t}),n=e.length-1;n>0;n--)e[n]===e[n-1]&&(e[n]*=2,e[n-1]=0);for(e=e.filter(function(t){return 0!==t});e.length<t.length;)e.unshift(0);return e}(t)});this.state=r(t),this.score+=i(this.initialState,t);var e=n(t,1);return this.initialState=e,this.initialState}}},{key:"moveUp",value:function(){if("idle"!==this.state){var t=function(t){for(var n=function(t){for(var e=r.map(function(e){return e[t]}),n=0;n<e.length-1;n++)e[n]===e[n+1]&&0!==e[n]&&(e[n]*=2,e[n+1]=0);for(var i=e.filter(function(t){return 0!==t});i.length<e.length;)i.push(0);for(var a=0;a<r.length;a++)r[a][t]=i[a]},r=t.map(function(t){return e(t)}),i=0;i<r[0].length;i++)n(i);return r}(this.initialState);this.state=r(t),this.score+=i(this.initialState,t);var a=n(t,1);return this.initialState=a,this.initialState}}},{key:"moveDown",value:function(){if("idle"!==this.state){var t=function(t){for(var n=function(t){for(var e=r.map(function(e){return e[t]}),n=e.length-1;n>0;n--)e[n]===e[n-1]&&0!==e[n]&&(e[n]*=2,e[n-1]=0);for(var i=e.filter(function(t){return 0!==t});i.length<e.length;)i.unshift(0);for(var a=0;a<r.length;a++)r[a][t]=i[a]},r=t.map(function(t){return e(t)}),i=0;i<r[0].length;i++)n(i);return r}(this.initialState);this.score+=i(this.initialState,t),this.state=r(t);var a=n(t,1);return this.initialState=a,this.initialState}}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.initialState}},{key:"getStatus",value:function(){return this.state}},{key:"start",value:function(){var t=this.initialState.flat().every(function(t){return 0===t})?n(this.initialState,2):n(this.initialState,1);return this.initialState=t,this.score=0,this.state="playing",this.initialState}},{key:"restart",value:function(){return this.initialState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.state="idle",this.initialState}}],function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(a.prototype,t),a}()),s=document.querySelector(".game-score"),o=document.querySelector(".start"),l=document.querySelector(".message-win"),u=document.querySelector(".message-lose"),c=document.querySelector(".message-start"),f=document.querySelectorAll(".field-cell");function h(t){var e=t.flat();f.forEach(function(t,n){t.textContent=e[n]||""});var n=a.getScore();s.textContent=n;var r=a.getStatus();"win"===r?l.classList.remove("hidden"):"lose"===r&&u.classList.remove("hidden")}function v(){c.classList.remove("hidden"),l.classList.add("hidden"),u.classList.add("hidden"),o.classList.add("start"),o.classList.remove("restart"),o.textContent="Start",h(a.restart())}function d(){if("idle"===a.getStatus()){var t=a.start();o.textContent="Restart",o.classList.add("restart"),o.classList.remove("start"),h(t),c.classList.add("hidden"),l.classList.add("hidden"),u.classList.add("hidden");return}"playing"===a.getStatus()&&v()}document.addEventListener("keydown",function(t){"Escape"===t.key&&v(),"Enter"===t.key&&d(),"playing"===a.getStatus()?("ArrowUp"===t.key&&h(a.moveUp()),"ArrowDown"===t.key&&h(a.moveDown()),"ArrowLeft"===t.key&&h(a.moveLeft()),"ArrowRight"===t.key&&h(a.moveRight())):"win"===a.getStatus()?(l.classList.remove("hidden"),o.classList.add("start"),o.classList.remove("restart"),o.textContent="Start"):"lose"===a.getStatus()&&(u.classList.remove("hidden"),o.classList.add("start"),o.classList.remove("restart"),o.textContent="Start")}),o.addEventListener("click",d)}();
//# sourceMappingURL=index.2b4a0322.js.map
